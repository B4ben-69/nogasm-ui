(this["webpackJsonpnogasm-ui"]=this["webpackJsonpnogasm-ui"]||[]).push([[0],{172:function(e,t,a){e.exports=a(357)},177:function(e,t,a){},355:function(e,t,a){},356:function(e,t,a){},357:function(e,t,a){"use strict";a.r(t);var s=a(1),n=a.n(s),i=a(48),r=a.n(i),c=(a(177),a(77)),l=a(18),o=a(129),h=a(130),d=a(142),u=a(140),m=(a(9),a(139)),g=a.n(m),p=(a(355),a(356),function(e){return e*(Math.PI/180)}),v=function(e,t,a,s,n){return(e-t)*(n-s)/(a-t)+s},f=function(e){for(var t=e.pressure,a=e.arousal,s=e.limit,i=Math.floor(v(t,0,4096,0,12)),r=(Math.floor(v(s,0,4096,0,12)),Math.floor(v(a,0,s,0,12))),c=[],l=0;l<13;l++){var o=13-l-1,h=40+280/12*l,d=300*Math.sin(p(h))/2+150,u=300*Math.cos(p(h))/2+150,m=50,g=0;o===i?(g=290,m=75):o<r?g=v(l,0,12,0,120):m=100,c[l]={color:"hsl(".concat(g,", 100%, ").concat(m,"%)"),x:d,y:u,rot:h,glow:m<100}}return n.a.createElement("div",{className:"led-ring",style:{width:300,height:300}},c.map((function(e,t){return n.a.createElement("div",{className:"led led-"+t,key:t,style:{backgroundColor:e.color,left:e.x,top:e.y,transform:"translate(-50%, -50%) rotate(-".concat(e.rot,"deg)"),boxShadow:e.glow?"0 0 10px 3px ".concat(e.color):"",opacity:e.glow?1:.8}})})),n.a.createElement("div",{className:"led-value"},Math.floor(a/s*100),"%"),n.a.createElement("div",{className:"led-stat"},"Arousal"))},E=a(141),b=function(e){var t,a=e.status,i=e.connected,r=e.onConnect,c=e.connecting,l=e.defaultAddress,o=void 0===l?"":l,h=Object(s.useState)(o),d=Object(E.a)(h,2),u=d[0],m=d[1];return i?n.a.createElement("header",{className:"App-header"},n.a.createElement("span",{className:"ssid"},a.ssid)," ",n.a.createElement("span",{className:"ip"},a.ip)," ",n.a.createElement("span",{className:"strength"},"(",(t=a.signalStrength)<-90?"Very Low":t<-80?"Low":t<-70?"Good":t<-60?"Very Good":t<-50?"Excellent":t<0?"Suspiciously Excellent":"Unknown",")")):c?n.a.createElement("header",{className:"App-header"},n.a.createElement("span",null,"Connecting to ",u,"...")):n.a.createElement("header",{className:"App-header"},n.a.createElement("form",{onSubmit:function(e){e.preventDefault(),r(u)}},n.a.createElement("label",{htmlFor:"device-address"},"Device Address: "),n.a.createElement("input",{id:"device-address",onChange:function(e){return m(e.target.value)},value:u}),n.a.createElement("button",{type:"submit"},"Connect")))},S=function(e){return n.a.createElement("div",{className:"sidebar"})},y=function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(e){var s;return Object(o.a)(this,a),(s=t.call(this,e)).HOST="192.168.1.172",s.ws=null,s.lastDraw=0,s.state={deviceAddress:"",connected:!1,log:[],pressure:[],sampleDepth:300,sampleRate:1,settings:{peakLimit:600,brightness:128},status:{ssid:"",ip:"",signalStrength:0}},s}return Object(h.a)(a,[{key:"handleBrightnessChange",value:function(e){e.preventDefault();var t=e.target.value;this.setState({settings:Object(l.a)(Object(l.a)({},this.state.settings),{},{brightness:t})}),this.send({cmd:"SET_BRIGHTNESS",brightness:t})}},{key:"handleLimitChange",value:function(e){e.preventDefault();var t=e.target.value;this.setState({settings:Object(l.a)(Object(l.a)({},this.state.settings),{},{peakLimit:t})}),this.send({cmd:"SET_LIMIT",limit:t})}},{key:"send",value:function(e){this.ws&&this.ws.sendMessage(JSON.stringify(e))}},{key:"log",value:function(e){var t=Object(c.a)(this.state.log);t.push(e),this.setState({log:t})}},{key:"reconnect",value:function(e){e.preventDefault(),this.send({cmd:"hello"})}},{key:"handleWsOpen",value:function(){this.setState({connected:!0}),this.log("Connected"),this.send({cmd:"GET_SETTINGS"}),this.send({cmd:"GET_WIFI_STATUS"}),this.send({cmd:"GET_SD_STATUS"})}},{key:"handleWsClose",value:function(){this.setState({connected:!1}),this.log("Closed")}},{key:"handleWsMessage",value:function(e){var t;try{t=JSON.parse(e)}catch(i){t={data:e},console.warn(i)}if("undefined"!==typeof t.pressure){var a=this.state.pressure.slice(0-(this.state.sampleDepth-1));t.millis=t.millis/1e3,this.setState({pressure:[].concat(Object(c.a)(a),[t])})}else console.log(t);if("SETTINGS"===t.cmd){var s=Object(l.a)({},this.state.settings);"undefined"!==typeof t.brightness&&(s.brightness=t.brightness),"undefined"!==typeof t.peak_limit&&(s.peakLimit=t.peak_limit),this.setState({settings:s})}if("WIFI_STATUS"===t.cmd){var n=Object(l.a)({},this.state.status);n.signalStrength=t.signal_strength,n.ip=t.ip,n.ssid=t.ssid,this.setState({status:n})}}},{key:"handleConnect",value:function(e){this.setState({deviceAddress:e})}},{key:"getLastData",value:function(){return this.state.pressure.length&&this.state.pressure[this.state.pressure.length-1]||{}}},{key:"render",value:function(){var e=this;return n.a.createElement("div",{className:"App"},this.state.deviceAddress&&n.a.createElement(g.a,{url:"ws://"+this.state.deviceAddress,onOpen:this.handleWsOpen.bind(this),onClose:this.handleWsClose.bind(this),ref:function(t){return e.ws=t},debug:!0,onMessage:this.handleWsMessage.bind(this)}),n.a.createElement(b,{connecting:!!this.state.deviceAddress,connected:this.state.connected,onConnect:this.handleConnect.bind(this),status:this.state.status}),n.a.createElement("div",{className:"content"},n.a.createElement(S,null),n.a.createElement("main",null,n.a.createElement("div",{className:"card"},n.a.createElement(f,{connected:this.state.connected,pressure:this.getLastData().pressure,arousal:this.getLastData().arousal,limit:this.state.settings.peakLimit})),n.a.createElement("div",{className:"card"}),n.a.createElement("div",{className:"controls"},n.a.createElement("div",{className:"control"},n.a.createElement("label",{htmlFor:"brightness"},"Brightness"),n.a.createElement("input",{type:"number",min:1,max:255,onChange:this.handleBrightnessChange.bind(this),id:"brightness",value:this.state.settings.brightness})),n.a.createElement("div",{className:"control"},n.a.createElement("label",{htmlFor:"brightness"},"Arousal Limit"),n.a.createElement("input",{type:"number",min:1,max:4096,onChange:this.handleLimitChange.bind(this),id:"limit",value:this.state.settings.peakLimit})),n.a.createElement("div",{className:"control"},n.a.createElement("a",{href:"#",onClick:this.reconnect.bind(this)},"Reconnect"))))))}}]),a}(s.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(y,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[172,1,2]]]);
//# sourceMappingURL=main.7d1df6bb.chunk.js.map